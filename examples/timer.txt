### Set up interrupt vectors
loadwi 15 0

# first vector
strapr 15 .intr_vec

# Point to next vector
addi 15 1 15

# Remaining vectors
.write_vector
strapr 15 .exit
addi 15 1 15
jmpgei 15 FF .write_done  # 256 vectors
jmp .write_vector  # Next vector

.write_done

eni  # Reenable interrupts


### Set up interrupt controller
savewi 20 FFFFEFD2
savewi .timer_intr FFFFEFD6
savebi 1 FFFFEFDA
savewi 0 FFFFEFCE

### Set up timer
savewi 64 FFFFEFC9

### Main loop
.loop
nop
jmplti A F .loop
halt


### Timer interrupt
.timer_intr
addi A 1 A
savewi 0 FFFFEFCE  # Re-enable interrupts
ret

### Interrupt vectors
.intr_vec
jmp FFFFEFEA
